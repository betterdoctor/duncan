{{ $app := .App }}
{{ $env := .Env }}
{{ $tag := .Tag }}
{
  "id": "/{{ $app }}-{{ $env }}",
  "dependencies": [],
  "version": "2017-05-10T20:56:48.035Z",
  "apps": [
    {{ range $idx, $a := .Apps }}
      {{ if $idx }},{{ end }}
      {
        "id": "/{{ $app }}-{{ $env }}/{{ $a.InstanceType }}",
        "cmd": "do it",
        "args": null,
        "user": null,
        "env": {},
        "instances": 10,
        "cpus": 1,
        "mem": 1024,
        "disk": 0,
        "gpus": 0,
        "executor": "",
        "constraints": [],
        "uris": [
          "https://s3.amazonaws.com/blah/configs/docker.tar.gz"
        ],
        "fetch": [
          {
            "uri": "https://s3.amazonaws.com/blah/configs/docker.tar.gz",
            "extract": true,
            "executable": false,
            "cache": false
          }
        ],
        "storeUrls": [],
        "backoffSeconds": 1,
        "backoffFactor": 1.15,
        "maxLaunchDelaySeconds": 3600,
        "container": {
          "type": "DOCKER",
          "volumes": [],
          "docker": {
            "image": "quay.io/foo/{{ $app }}:{{ $tag }}",
            "network": "BRIDGE",
            "portMappings": [
              {
                "containerPort": 3000,
                "hostPort": 0,
                "servicePort": 10146,
                "protocol": "tcp",
                "labels": {}
              }
            ],
            "privileged": false,
            "parameters": [],
            "forcePullImage": false
          }
        },
        "healthChecks": [
          {
            "path": "/",
            "protocol": "HTTP",
            "portIndex": 0,
            "gracePeriodSeconds": 300,
            "intervalSeconds": 20,
            "timeoutSeconds": 600,
            "maxConsecutiveFailures": 5,
            "ignoreHttp1xx": false
          }
        ],
        "readinessChecks": [],
        "dependencies": [],
        "upgradeStrategy": {
          "minimumHealthCapacity": 1,
          "maximumOverCapacity": 1
        },
        "labels": {
          "HAPROXY_GROUP": "external"
        },
        "acceptedResourceRoles": null,
        "ipAddress": null,
        "version": "2017-05-10T20:53:26.396Z",
        "residency": null,
        "secrets": {},
        "taskKillGracePeriodSeconds": null,
        "ports": [
          10146
        ],
        "portDefinitions": [
          {
            "port": 10146,
            "protocol": "tcp",
            "labels": {}
          }
        ],
        "requirePorts": false,
        "versionInfo": {
          "lastScalingAt": "2017-05-10T20:53:26.396Z",
          "lastConfigChangeAt": "2017-05-10T20:48:55.174Z"
        }
      }
    {{ end }}
  ]
}